<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">

<title>会员注册</title>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">

 function callback(result) {  
    alert('success');  
    alert(result);  //输出openid
  }  
  
function getQueryString(name) {
  var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
  var r = window.location.search.substr(1).match(reg);
  if (r != null) return unescape(r[2]); return null;
  }


var code = getQueryString("code");

$.ajax({ 
    async: false, 
    url: "http://mushaf.sinaapp.com/oauth2.php", //这是我的服务端处理文件php的
    type: "GET", 
    dataType:"json",
    data: {code:code}, //传递本页面获取的code到后台，以便后台获取openid
    //timeout: 5000, 
    success: function (result) { 
        //callback(result);
        alert("ajax success");
        alert(result.openid);
        document.write(result.openid);
    }, 
    error: function (jqXHR, textStatus, errorThrown) { 
        alert("ajax error");
        //alertt(jqXHR);
        alert(textStatus); 
        alert(errorThrown);
        var ans=errorThrown;
        document.write(ans);
    } 
  });


</script>
</head>
<body>

</body>
</html>