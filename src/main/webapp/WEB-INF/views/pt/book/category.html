<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>IOT-图书分类</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
		<meta name="format-detection" content="telphone=no, email=no"/>
		<meta name="renderer" content="webkit">
		<meta name="theme-color" content="#ee3e80">
		<link href="/wx/css/bootstrap.css" rel="stylesheet" type="text/css">
		<link href="/wx/css/bootstrap-theme.css" rel="stylesheet" type="text/css">
		<link href="/wx/css/iot.css" rel="stylesheet" type="text/css">
		<script src="/wx/js/jquery.js"></script>
		<script src="/wx/js/bootstrap.js"></script>
		<script src="/wx/js/iot.js"></script>
		<script src="/wx/js/storage.js"></script>
	</head>

	<body>
	

		<div  class="container-fluid">
			<h3 class="category_info">书目：</h3>
			<table class="table table-striped table-hover" id="category_table">
				<tr>
					<th>书名</th>
					<th>作者</th>
					<th>出版社</th>
					<th></th>
				</tr>
			</table>

		</div>

		<div class="modal fade">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title">Modal title</h4>
		      </div>
		      <div class="modal-body">
		        <p>One fine body&hellip;</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="button" class="btn btn-primary">Save changes</button>
		      </div>
		    </div><!-- /.modal-content -->
		  </div><!-- /.modal-dialog -->
		</div><!-- /.modal -->



		<div id="masker"></div>
		<div id="showdetail">
			<br>
			<b id="bookName"></b><hr style="border-bottom:1px solid #999;"/>
			<div>
				<p>评分：<span id="points"></span></p>
				<!-- <p>馆藏数量：<span id="totalnumber"></span></p> -->
				<p>可借数量：<span id="availablenumber"></span></p>
				<span id="borrow" class="btn goodbtn">现在借阅</span>
				<p style="text-align:left;margin:10px;">图书简介：<span id="brief"></span></p>
			</div>
		</div>








		<script>
			$(function(){
				var selected_category = getCookie("selected_category");
				$(".category_info").prepend(selected_category);
				$.ajax({
					type:"POST",
					url:"category.do",
					data:{
						selectedCategory:selected_category
					},
					dataType:"json",
					success: function(result){
						if (result.success) {
							showCategory(result);
						} else {
							alert("抱歉，暂无藏书");
						}
					},
					error: function(jqXHR){
					   alert("分类页面加载ajax发生错误：" + jqXHR.status);  
					},
				});
				function showCategory(result){
					$("#category_table tr:gt(0)").remove();
					var table = $("#category_table");		
					$.each(result.list,function(k,v){
						var td_object={};
						$.each(v, function(k1, v1) {
							td_object[''+k1+'']=v1;
							console.log(k1+'  '+v1);
						});
						var tr=$("<tr/>");
						tr.html('<td>'+td_object.bookName+'</td><td>'+td_object.author+'</td><td>'+td_object.publisher+'</td><td><span class="go-popup detail btn-success">详情</span></td><td class="hide_td">'+td_object.id+'</td><td class="hide_td">'+td_object.publishTime+'</td><td class="hide_td">'+td_object.amount+'</td><td class="hide_td">'+td_object.borrowed+'</td><td class="hide_td">'+td_object.points+'</td><td class="hide_td">'+td_object.brief+'</td>');
						tr.appendTo(table);
					});		
				}
			});
		</script>

	</body>

</html>